"use strict";(globalThis.webpackChunkmetacall_doc=globalThis.webpackChunkmetacall_doc||[]).push([[7669],{8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>i});var r=n(6540);const s={},o=r.createContext(s);function l(e){const t=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(o.Provider,{value:t},e.children)}},9486:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"metacall-core/ports","title":"Ports","description":"Relevant source files","source":"@site/docs/metacall-core/ports.md","sourceDirName":"metacall-core","slug":"/metacall-core/ports","permalink":"/doc/docs/metacall-core/ports","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Ports"},"sidebar":"tutorialSidebar","previous":{"title":"Port System","permalink":"/doc/docs/metacall-core/port-system"},"next":{"title":"Prerequisites","permalink":"/doc/docs/metacall-core/prerequisites"}}');var s=n(4848),o=n(8453);const l={title:"Ports"},i="Ports",a={},c=[{value:"Relevant source files",id:"relevant-source-files",level:2},{value:"Port System Architecture",id:"port-system-architecture",level:2},{value:"Port Implementation Pattern",id:"port-implementation-pattern",level:2},{value:"Available Ports",id:"available-ports",level:2},{value:"Node.js Port",id:"nodejs-port",level:3},{value:"Node.js Port Implementation",id:"nodejs-port-implementation",level:4},{value:"Node.js Port API",id:"nodejs-port-api",level:4},{value:"Node.js Port Usage Examples",id:"nodejs-port-usage-examples",level:4},{value:"Python Port",id:"python-port",level:3},{value:"Python Port Implementation",id:"python-port-implementation",level:4},{value:"Python Port Usage Example",id:"python-port-usage-example",level:4},{value:"Ruby Port",id:"ruby-port",level:3},{value:"Ruby Port Implementation",id:"ruby-port-implementation",level:4},{value:"Other Ports",id:"other-ports",level:3},{value:"Type Conversion System",id:"type-conversion-system",level:2},{value:"Cross-Language Function Call Flow",id:"cross-language-function-call-flow",level:2},{value:"Creating Custom Ports",id:"creating-custom-ports",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"ports",children:"Ports"})}),"\n",(0,s.jsx)(t.h2,{id:"relevant-source-files",children:"Relevant source files"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/VERSION",children:"VERSION"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/cmake/FindMetaCall.cmake",children:"cmake/FindMetaCall.cmake"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/loaders/node_loader/include/node_loader/node_loader_port.h",children:"source/loaders/node_loader/include/node_loader/node_loader_port.h"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/java_port/CMakeLists.txt",children:"source/ports/java_port/CMakeLists.txt"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/js_port/CMakeLists.txt",children:"source/ports/js_port/CMakeLists.txt"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/.gitignore",children:"source/ports/node_port/.gitignore"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/.npmignore",children:"source/ports/node_port/.npmignore"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/LICENSE",children:"source/ports/node_port/LICENSE"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/README.md",children:"source/ports/node_port/README.md"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/index.js",children:"source/ports/node_port/index.js"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/package-lock.json",children:"source/ports/node_port/package-lock.json"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/package.json",children:"source/ports/node_port/package.json"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/node_port/test/index.js",children:"source/ports/node_port/test/index.js"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/py_port/CMakeLists.txt",children:"source/ports/py_port/CMakeLists.txt"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/ports/rb_port/CMakeLists.txt",children:"source/ports/rb_port/CMakeLists.txt"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/reflect/include/reflect/reflect_value.h",children:"source/reflect/include/reflect/reflect_value.h"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/reflect/source/reflect_value.c",children:"source/reflect/source/reflect_value.c"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/scripts/python/function/source/function.py",children:"source/scripts/python/function/source/function.py"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/memcheck/valgrind-suppressions.sh",children:"source/tests/memcheck/valgrind-suppressions.sh"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/metacall_function_test/source/metacall_function_test.cpp",children:"source/tests/metacall_function_test/source/metacall_function_test.cpp"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/metacall_node_reentrant_test/CMakeLists.txt",children:"source/tests/metacall_node_reentrant_test/CMakeLists.txt"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/metacall_python_reentrant_test/source/metacall_python_reentrant_test.cpp",children:"source/tests/metacall_python_reentrant_test/source/metacall_python_reentrant_test.cpp"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/metacall/core/blob/af9cad19/tools/runtime/Dockerfile",children:"tools/runtime/Dockerfile"})}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Ports in MetaCall are language-specific interfaces that allow developers to use MetaCall's cross-language function call capabilities from their preferred programming language. They bridge MetaCall Core functionality to specific language environments, providing a natural and idiomatic way to access foreign language code."}),"\n",(0,s.jsxs)(t.p,{children:["For information about loading and executing code from different programming languages, see the ",(0,s.jsx)(t.a,{href:"/doc/docs/metacall-core/loader-system",children:"Loader System"})," documentation. While loaders execute foreign code, ports provide the API for accessing MetaCall from a specific language."]}),"\n",(0,s.jsx)(t.h2,{id:"port-system-architecture",children:"Port System Architecture"}),"\n",(0,s.jsx)(t.p,{children:"Ports connect MetaCall Core to language-specific runtimes, handling type conversions and providing language-appropriate interfaces to MetaCall's functionality."}),"\n",(0,s.jsx)(t.h2,{id:"port-implementation-pattern",children:"Port Implementation Pattern"}),"\n",(0,s.jsx)(t.p,{children:"Ports typically follow this implementation pattern:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Library Discovery & Loading"}),": Finding and loading the MetaCall Core library"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Initialization"}),": Setting up the MetaCall runtime"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"API Wrapping"}),": Providing language-specific wrappers for core functions"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Type Conversion"}),": Converting between language types and MetaCall's value system"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Integration"}),": Integrating with language-specific features (e.g., module systems)"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"available-ports",children:"Available Ports"}),"\n",(0,s.jsx)(t.h3,{id:"nodejs-port",children:"Node.js Port"}),"\n",(0,s.jsx)(t.p,{children:"The Node.js port is the most comprehensively developed port in MetaCall. It allows JavaScript code running in Node.js to seamlessly interact with code written in other languages supported by MetaCall."}),"\n",(0,s.jsx)(t.h4,{id:"nodejs-port-implementation",children:"Node.js Port Implementation"}),"\n",(0,s.jsx)(t.p,{children:"The Node.js port consists of:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"A JavaScript module that provides the API"}),"\n",(0,s.jsx)(t.li,{children:"Native bindings to the MetaCall Core library"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"At initialization, the port:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Finds the MetaCall library using platform-specific paths or the ",(0,s.jsx)(t.code,{children:"METACALL_INSTALL_PATH"})," environment variable"]}),"\n",(0,s.jsxs)(t.li,{children:["Loads the library using Node.js's ",(0,s.jsx)(t.code,{children:"process.dlopen"})]}),"\n",(0,s.jsx)(t.li,{children:"Initializes the MetaCall runtime"}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"nodejs-port-api",children:"Node.js Port API"}),"\n",(0,s.jsx)(t.p,{children:"The Node.js port provides the following main functions:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Function"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacall(name, ...args)"})}),(0,s.jsx)(t.td,{children:"Call a function by name with arguments"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacallfms(name, buffer)"})}),(0,s.jsx)(t.td,{children:"Call a function with JSON-formatted arguments"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacall_load_from_file(tag, paths)"})}),(0,s.jsx)(t.td,{children:"Load code from files with language tag"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacall_load_from_memory(tag, code)"})}),(0,s.jsx)(t.td,{children:"Load code from a string with language tag"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacall_load_from_package(tag, pkg)"})}),(0,s.jsx)(t.td,{children:"Load code from a package with language tag"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metacall_inspect()"})}),(0,s.jsx)(t.td,{children:"Get metadata about loaded modules and functions"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:["It also modifies Node.js's ",(0,s.jsx)(t.code,{children:"require()"})," function to enable imports from other languages:"]}),(0,s.jsx)(t.td,{})]})]})]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Direct imports by extension (e.g., ",(0,s.jsx)(t.code,{children:"require('./script.py')"}),")"]}),"\n",(0,s.jsxs)(t.li,{children:["Explicit tag imports (e.g., ",(0,s.jsx)(t.code,{children:"require('py:module')"}),")"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"nodejs-port-usage-examples",children:"Node.js Port Usage Examples"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Basic usage:"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Loading code from memory:"})}),"\n",(0,s.jsx)(t.h3,{id:"python-port",children:"Python Port"}),"\n",(0,s.jsx)(t.p,{children:"The Python port allows Python applications to use MetaCall for calling functions from other languages."}),"\n",(0,s.jsx)(t.h4,{id:"python-port-implementation",children:"Python Port Implementation"}),"\n",(0,s.jsx)(t.p,{children:"The Python port is distributed as a Python package that can be installed via pip. It provides Python bindings to the MetaCall Core library and follows a similar pattern to the Node.js port."}),"\n",(0,s.jsx)(t.h4,{id:"python-port-usage-example",children:"Python Port Usage Example"}),"\n",(0,s.jsx)(t.h3,{id:"ruby-port",children:"Ruby Port"}),"\n",(0,s.jsx)(t.p,{children:"The Ruby port enables Ruby applications to use MetaCall for cross-language function calls."}),"\n",(0,s.jsx)(t.h4,{id:"ruby-port-implementation",children:"Ruby Port Implementation"}),"\n",(0,s.jsx)(t.p,{children:"The Ruby port is implemented using SWIG to generate Ruby bindings for the MetaCall Core library. It creates a Ruby extension module that interfaces with MetaCall."}),"\n",(0,s.jsx)(t.h3,{id:"other-ports",children:"Other Ports"}),"\n",(0,s.jsx)(t.p,{children:"MetaCall also includes or is developing ports for:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Rust Port"}),": Enables Rust applications to use MetaCall"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Go Port"}),": Enables Go applications to use MetaCall"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Java Port"}),": Provides Java bindings to MetaCall (work in progress)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"JavaScript Port (V8)"}),": Direct bindings to V8 JavaScript engine"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"type-conversion-system",children:"Type Conversion System"}),"\n",(0,s.jsx)(t.p,{children:"A key responsibility of ports is bidirectional conversion between language-specific types and MetaCall's value system."}),"\n",(0,s.jsx)(t.h2,{id:"cross-language-function-call-flow",children:"Cross-Language Function Call Flow"}),"\n",(0,s.jsx)(t.p,{children:"The sequence of a cross-language function call through a port:"}),"\n",(0,s.jsx)(t.h2,{id:"creating-custom-ports",children:"Creating Custom Ports"}),"\n",(0,s.jsx)(t.p,{children:"While MetaCall already provides ports for several languages, you can create new ports for other languages by:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Creating bindings to the MetaCall Core library"}),"\n",(0,s.jsx)(t.li,{children:"Implementing bidirectional type conversion"}),"\n",(0,s.jsx)(t.li,{children:"Providing wrappers for core functions"}),"\n",(0,s.jsx)(t.li,{children:"Handling initialization, shutdown, and resource management"}),"\n",(0,s.jsx)(t.li,{children:"Optionally integrating with the language's module system"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Studying existing port implementations provides valuable examples:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Node.js port: A comprehensive example with module system integration"}),"\n",(0,s.jsx)(t.li,{children:"Ruby port: An example using SWIG"}),"\n",(0,s.jsx)(t.li,{children:"Python port: A simpler implementation"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,s.jsx)(t.p,{children:"When using ports, consider these performance factors:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Type Conversion Overhead"}),": Each conversion between language types and MetaCall values adds overhead"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Cross-Language Boundary Costs"}),": Each call crosses at least two language boundaries"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Serialization"}),": Complex data structures may need serialization/deserialization"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"To optimize performance:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Minimize the number of cross-language calls"}),"\n",(0,s.jsx)(t.li,{children:"Batch operations when possible"}),"\n",(0,s.jsx)(t.li,{children:"Keep performance-critical code within a single language"}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);