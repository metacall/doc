"use strict";(globalThis.webpackChunkmetacall_doc=globalThis.webpackChunkmetacall_doc||[]).push([[7404],{2714:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"metacall-core/testing-framework","title":"Testing Framework","description":"The MetaCall testing framework provides a comprehensive suite of tools and methodologies for ensuring code quality, correctness, and reliability across the codebase. This page describes the architecture, components, and usage of the testing infrastructure within the MetaCall project. For information about benchmarking, see page 8.3 on Sanitizers.","source":"@site/docs/metacall-core/testing-framework.md","sourceDirName":"metacall-core","slug":"/metacall-core/testing-framework","permalink":"/doc/docs/metacall-core/testing-framework","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Testing Framework"},"sidebar":"tutorialSidebar","previous":{"title":"Supported Languages","permalink":"/doc/docs/metacall-core/supported-languages"},"next":{"title":"Value Handling","permalink":"/doc/docs/metacall-core/value-handling"}}');var i=n(4848),r=n(8453);const l={title:"Testing Framework"},o="Testing Framework",a={},c=[{value:"1. Testing Architecture Overview",id:"1-testing-architecture-overview",level:2},{value:"2. Testing Components",id:"2-testing-components",level:2},{value:"2.1 Google Test Integration",id:"21-google-test-integration",level:3},{value:"2.2 Memory Check Configuration",id:"22-memory-check-configuration",level:3},{value:"2.3 Test Environment Variables",id:"23-test-environment-variables",level:3},{value:"3. Test Categories",id:"3-test-categories",level:2},{value:"3.1 Core Component Tests",id:"31-core-component-tests",level:3},{value:"3.2 MetaCall API Tests",id:"32-metacall-api-tests",level:3},{value:"3.3 Language-Specific Tests",id:"33-language-specific-tests",level:3},{value:"3.4 Cross-Platform Tests",id:"34-cross-platform-tests",level:3},{value:"4. Test Execution",id:"4-test-execution",level:2},{value:"4.1 Running Tests Locally",id:"41-running-tests-locally",level:3},{value:"4.2 Test Execution Flow",id:"42-test-execution-flow",level:3},{value:"5. Sanitizers",id:"5-sanitizers",level:2},{value:"5.1 Available Sanitizers",id:"51-available-sanitizers",level:3},{value:"5.2 Running Tests with Sanitizers",id:"52-running-tests-with-sanitizers",level:3},{value:"6. CI/CD Integration",id:"6-cicd-integration",level:2},{value:"6.1 Test Matrix",id:"61-test-matrix",level:3},{value:"6.2 Docker-based Testing",id:"62-docker-based-testing",level:3},{value:"6.3 Test Result Handling",id:"63-test-result-handling",level:3},{value:"7. Writing New Tests",id:"7-writing-new-tests",level:2},{value:"7.1 Test Structure",id:"71-test-structure",level:3},{value:"7.2 Test Naming Convention",id:"72-test-naming-convention",level:3},{value:"7.3 Common Test Environment",id:"73-common-test-environment",level:3},{value:"8. Conclusion",id:"8-conclusion",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"testing-framework",children:"Testing Framework"})}),"\n",(0,i.jsx)(t.p,{children:"The MetaCall testing framework provides a comprehensive suite of tools and methodologies for ensuring code quality, correctness, and reliability across the codebase. This page describes the architecture, components, and usage of the testing infrastructure within the MetaCall project. For information about benchmarking, see page 8.3 on Sanitizers."}),"\n",(0,i.jsx)(t.h2,{id:"1-testing-architecture-overview",children:"1. Testing Architecture Overview"}),"\n",(0,i.jsx)(t.p,{children:"The MetaCall testing system uses Google Test (GTest) as its primary unit testing framework and CTest for test execution and management. The testing infrastructure is tightly integrated with the build system and continuous integration pipelines to ensure code quality across multiple platforms and configurations."}),"\n",(0,i.jsx)(t.h2,{id:"2-testing-components",children:"2. Testing Components"}),"\n",(0,i.jsx)(t.h3,{id:"21-google-test-integration",children:"2.1 Google Test Integration"}),"\n",(0,i.jsx)(t.p,{children:"MetaCall uses Google Test (GTest) version 1.11.0 as its primary testing framework. If GTest is not found on the system, it will be automatically installed through CMake."}),"\n",(0,i.jsx)(t.p,{children:"The test infrastructure creates an interface library for GTest that all test targets can link against:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"add_library(GTest INTERFACE)\ntarget_include_directories(GTest SYSTEM INTERFACE ${GTEST_INCLUDE_DIRS})\ntarget_link_libraries(GTest INTERFACE ${GTEST_LIBRARIES})\n"})}),"\n",(0,i.jsx)(t.h3,{id:"22-memory-check-configuration",children:"2.2 Memory Check Configuration"}),"\n",(0,i.jsxs)(t.p,{children:["The testing framework supports running tests with memory checkers like Valgrind. This is controlled by the ",(0,i.jsx)(t.code,{children:"OPTION_TEST_MEMORYCHECK"})," option. Memory checks are disabled when using sanitizers as they are not compatible."]}),"\n",(0,i.jsx)(t.h3,{id:"23-test-environment-variables",children:"2.3 Test Environment Variables"}),"\n",(0,i.jsx)(t.p,{children:"Tests require specific environment variables to locate loaders, configurations, and other components:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Environment Variable"}),(0,i.jsx)(t.th,{children:"Purpose"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"LOADER_LIBRARY_PATH"})}),(0,i.jsx)(t.td,{children:"Directory where loader plugins are located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"LOADER_SCRIPT_PATH"})}),(0,i.jsx)(t.td,{children:"Directory where scripts to be loaded are located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"CONFIGURATION_PATH"})}),(0,i.jsx)(t.td,{children:"Path to the MetaCall global configuration"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"SERIAL_LIBRARY_PATH"})}),(0,i.jsx)(t.td,{children:"Directory where serial plugins are located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"DETOUR_LIBRARY_PATH"})}),(0,i.jsx)(t.td,{children:"Directory where detour plugins are located"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:"PORT_LIBRARY_PATH"})}),(0,i.jsx)(t.td,{children:"Directory where port plugins are located"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"3-test-categories",children:"3. Test Categories"}),"\n",(0,i.jsx)(t.p,{children:"The MetaCall test suite is organized into several categories, each targeting different aspects of the system:"}),"\n",(0,i.jsx)(t.h3,{id:"31-core-component-tests",children:"3.1 Core Component Tests"}),"\n",(0,i.jsx)(t.p,{children:"These tests verify the functionality of the core libraries and subsystems:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Preprocessor and environment tests"}),": Test MetaCall's preprocessor directives and environment handling"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Abstract Data Type (ADT) tests"}),": Verify data structures like sets, tries, vectors, and maps"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Reflection system tests"}),": Test the type system, value casting, functions, objects, and scopes"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Dynamic linking tests"}),": Verify the dynamic library loading functionality"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Detour tests"}),": Test function interception capabilities"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Serialization tests"}),": Verify data serialization/deserialization"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"32-metacall-api-tests",children:"3.2 MetaCall API Tests"}),"\n",(0,i.jsx)(t.p,{children:"Tests focusing on the MetaCall API functionality:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Loading/unloading"}),": Test loading code from files and memory"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Function calls"}),": Verify cross-language function calls"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Configuration"}),": Test configuration loading and validation"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Error handling"}),": Verify proper error detection and reporting"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Memory management"}),": Test allocation and deallocation of resources"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"33-language-specific-tests",children:"3.3 Language-Specific Tests"}),"\n",(0,i.jsx)(t.p,{children:"Tests targeting specific language loaders and their integrations:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Python tests"}),": Test Python loader functionality, object models, garbage collection"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Node.js tests"}),": Test Node.js event loop, async functions, callbacks"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Ruby tests"}),": Test Ruby object models and integration"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"C# tests"}),": Test .NET Core integration"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"TypeScript tests"}),": Test TypeScript compilation and execution"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Other languages"}),": Tests for C, Rust, WebAssembly, Java, etc."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"34-cross-platform-tests",children:"3.4 Cross-Platform Tests"}),"\n",(0,i.jsx)(t.p,{children:"MetaCall is tested across multiple platforms to ensure compatibility:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Linux"}),": Tests on various distributions (Debian, Ubuntu, Alpine)"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"macOS"}),": Tests on multiple macOS versions"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Windows"}),": Tests on Windows using MSVC"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Each platform has dedicated GitHub workflows that run the tests in appropriate environments."}),"\n",(0,i.jsx)(t.h2,{id:"4-test-execution",children:"4. Test Execution"}),"\n",(0,i.jsx)(t.h3,{id:"41-running-tests-locally",children:"4.1 Running Tests Locally"}),"\n",(0,i.jsx)(t.p,{children:"To build and run the tests locally, you can use the provided build scripts:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Set up the environment with required dependencies:"}),"\n",(0,i.jsx)(t.li,{children:"Configure the build with tests enabled:"}),"\n",(0,i.jsx)(t.li,{children:"Build and run the tests:"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"42-test-execution-flow",children:"4.2 Test Execution Flow"}),"\n",(0,i.jsx)(t.h2,{id:"5-sanitizers",children:"5. Sanitizers"}),"\n",(0,i.jsx)(t.p,{children:"MetaCall includes support for various sanitizers to detect memory and threading issues:"}),"\n",(0,i.jsx)(t.h3,{id:"51-available-sanitizers",children:"5.1 Available Sanitizers"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Address Sanitizer"}),": Detects memory errors such as buffer overflows, use-after-free, etc."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Thread Sanitizer"}),": Detects data races and other threading issues"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Memory Sanitizer"}),": Detects uninitialized memory reads"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"These sanitizers are enabled during configuration and are used extensively in CI/CD pipelines."}),"\n",(0,i.jsx)(t.h3,{id:"52-running-tests-with-sanitizers",children:"5.2 Running Tests with Sanitizers"}),"\n",(0,i.jsx)(t.p,{children:"To run tests with sanitizers, use the provided sanitizer script:"}),"\n",(0,i.jsx)(t.p,{children:"Alternatively, configure and build with sanitizer options:"}),"\n",(0,i.jsx)(t.h2,{id:"6-cicd-integration",children:"6. CI/CD Integration"}),"\n",(0,i.jsx)(t.p,{children:"MetaCall's testing framework is tightly integrated with the CI/CD pipeline through GitHub Actions."}),"\n",(0,i.jsx)(t.h3,{id:"61-test-matrix",children:"6.1 Test Matrix"}),"\n",(0,i.jsx)(t.p,{children:"Tests are run in a matrix configuration across:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Operating Systems"}),": Linux, macOS, Windows"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Build Types"}),": Debug, Release"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Sanitizers"}),": Address, Thread, Memory (on supported platforms)"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Base Images"}),": Various Linux distributions for Docker-based tests"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"62-docker-based-testing",children:"6.2 Docker-based Testing"}),"\n",(0,i.jsx)(t.p,{children:"For Linux environments, tests run in Docker containers to ensure consistent execution environments:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Build the Docker images with dependencies"}),"\n",(0,i.jsx)(t.li,{children:"Run the tests inside the containers"}),"\n",(0,i.jsx)(t.li,{children:"Generate reports for success/failure"}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"63-test-result-handling",children:"6.3 Test Result Handling"}),"\n",(0,i.jsx)(t.p,{children:"Test results trigger several workflows:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Failed tests"})," cause the workflow to fail"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Successful tests"})," on ",(0,i.jsx)(t.code,{children:"master"})," branch may trigger distributable builds"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Benchmarks"})," collect performance metrics for analysis"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"7-writing-new-tests",children:"7. Writing New Tests"}),"\n",(0,i.jsx)(t.h3,{id:"71-test-structure",children:"7.1 Test Structure"}),"\n",(0,i.jsx)(t.p,{children:"New tests should follow the established pattern:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["Create a new directory under ",(0,i.jsx)(t.code,{children:"source/tests/"})," for your test"]}),"\n",(0,i.jsx)(t.li,{children:"Create a CMakeLists.txt file in your test directory"}),"\n",(0,i.jsx)(t.li,{children:"Define a test executable and link it with GTest"}),"\n",(0,i.jsx)(t.li,{children:"Set up test environment variables"}),"\n",(0,i.jsxs)(t.li,{children:["Add the test to ",(0,i.jsx)(t.code,{children:"source/tests/CMakeLists.txt"})]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"72-test-naming-convention",children:"7.2 Test Naming Convention"}),"\n",(0,i.jsx)(t.p,{children:"Test executable names should follow the pattern:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Unit tests"}),": ",(0,i.jsx)(t.code,{children:"component_test"})," (e.g., ",(0,i.jsx)(t.code,{children:"log_test"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Integration tests"}),": ",(0,i.jsx)(t.code,{children:"metacall_component_test"})," (e.g., ",(0,i.jsx)(t.code,{children:"metacall_python_test"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Specialized tests"}),": ",(0,i.jsx)(t.code,{children:"metacall_component_subcomponent_test"})," (e.g., ",(0,i.jsx)(t.code,{children:"metacall_python_object_class_test"}),")"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"73-common-test-environment",children:"7.3 Common Test Environment"}),"\n",(0,i.jsx)(t.p,{children:"Tests share common environment variables for locating MetaCall components:"}),"\n",(0,i.jsx)(t.h2,{id:"8-conclusion",children:"8. Conclusion"}),"\n",(0,i.jsx)(t.p,{children:"The MetaCall testing framework is a comprehensive system for ensuring code quality and reliability across multiple languages, platforms, and configurations. It integrates unit tests, integration tests, and various sanitizers into a cohesive testing infrastructure that is executed through both local development and CI/CD pipelines."}),"\n",(0,i.jsx)(t.p,{children:"By leveraging Google Test, CTest, and Docker, MetaCall achieves a robust testing environment that can detect issues across the wide range of languages and platforms it supports."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var s=n(6540);const i={},r=s.createContext(i);function l(e){const t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);