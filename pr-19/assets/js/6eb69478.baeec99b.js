"use strict";(globalThis.webpackChunkmetacall_doc=globalThis.webpackChunkmetacall_doc||[]).push([[5546],{3274:(e,i,s)=>{s.r(i),s.d(i,{assets:()=>o,contentTitle:()=>n,default:()=>p,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"metacall-core/serialization-formats","title":"Serialization Formats","description":"Overview","source":"@site/docs/metacall-core/serialization-formats.md","sourceDirName":"metacall-core","slug":"/metacall-core/serialization-formats","permalink":"/doc/docs/metacall-core/serialization-formats","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Serialization Formats"},"sidebar":"tutorialSidebar","previous":{"title":"Serialization and Value System","permalink":"/doc/docs/metacall-core/serialization-and-value-system"},"next":{"title":"Supported Languages","permalink":"/doc/docs/metacall-core/supported-languages"}}');var a=s(4848),l=s(8453);const t={title:"Serialization Formats"},n="Serialization Formats",o={},c=[{value:"Overview",id:"overview",level:2},{value:"Serialization Architecture",id:"serialization-architecture",level:2},{value:"Serialization Components and Flow",id:"serialization-components-and-flow",level:3},{value:"Supported Serialization Formats",id:"supported-serialization-formats",level:2},{value:"1. JSON (RapidJSON)",id:"1-json-rapidjson",level:3},{value:"2. MetaCall Native Format",id:"2-metacall-native-format",level:3},{value:"Serialization and Deserialization Process",id:"serialization-and-deserialization-process",level:2},{value:"Type Handling in RapidJSON Serialization",id:"type-handling-in-rapidjson-serialization",level:2},{value:"Primitives and Simple Types",id:"primitives-and-simple-types",level:3},{value:"Complex Types (Buffer, Array, Map)",id:"complex-types-buffer-array-map",level:3},{value:"Buffer Serialization",id:"buffer-serialization",level:4},{value:"Array Serialization",id:"array-serialization",level:4},{value:"Map Serialization",id:"map-serialization",level:4},{value:"Special Types (Exception, Throwable)",id:"special-types-exception-throwable",level:3},{value:"Deserialization Process",id:"deserialization-process",level:2},{value:"Using the Serialization API",id:"using-the-serialization-api",level:2},{value:"Basic Usage Pattern",id:"basic-usage-pattern",level:3},{value:"Examples with Different Types",id:"examples-with-different-types",level:3},{value:"Serializing Primitive Values",id:"serializing-primitive-values",level:4},{value:"Serializing Complex Types",id:"serializing-complex-types",level:4},{value:"Adding Custom Serialization Formats",id:"adding-custom-serialization-formats",level:2},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const i={a:"a",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.header,{children:(0,a.jsx)(i.h1,{id:"serialization-formats",children:"Serialization Formats"})}),"\n",(0,a.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(i.p,{children:"The MetaCall Serialization system provides a framework for converting MetaCall values to and from various data formats. This system is essential for cross-language interoperability, remote procedure calls, and data persistence. The serialization framework is part of the larger MetaCall Core and works closely with the Value System to handle the conversion of data types across different languages and formats."}),"\n",(0,a.jsxs)(i.p,{children:["For information about the value types themselves, see ",(0,a.jsx)(i.a,{href:"/doc/docs/metacall-core/value-types",children:"Value Types"}),"."]}),"\n",(0,a.jsx)(i.h2,{id:"serialization-architecture",children:"Serialization Architecture"}),"\n",(0,a.jsx)(i.p,{children:"The serialization system uses a plugin-based architecture where different serialization formats can be registered and used through a common interface."}),"\n",(0,a.jsx)(i.h3,{id:"serialization-components-and-flow",children:"Serialization Components and Flow"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L49-L68",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp49-68"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L355-L368",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp355-368"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"supported-serialization-formats",children:"Supported Serialization Formats"}),"\n",(0,a.jsx)(i.h3,{id:"1-json-rapidjson",children:"1. JSON (RapidJSON)"}),"\n",(0,a.jsx)(i.p,{children:"The primary serialization format in MetaCall is JSON, implemented using the RapidJSON library. This format provides a comprehensive mapping between MetaCall values and standard JSON."}),"\n",(0,a.jsx)(i.p,{children:"Type mappings:"}),"\n",(0,a.jsxs)(i.table,{children:[(0,a.jsx)(i.thead,{children:(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.th,{children:"MetaCall Type"}),(0,a.jsx)(i.th,{children:"JSON Representation"})]})}),(0,a.jsxs)(i.tbody,{children:[(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Boolean"}),(0,a.jsx)(i.td,{children:"Boolean (true/false)"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Char, Short, Int, Long"}),(0,a.jsx)(i.td,{children:"Number"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Float, Double"}),(0,a.jsx)(i.td,{children:"Number (with decimal)"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"String"}),(0,a.jsx)(i.td,{children:"String"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Buffer"}),(0,a.jsx)(i.td,{children:'Object with "data" array and "length" field'})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Array"}),(0,a.jsx)(i.td,{children:"Array"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Map"}),(0,a.jsx)(i.td,{children:"Object"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Pointer"}),(0,a.jsx)(i.td,{children:"String (memory address)"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Function"}),(0,a.jsx)(i.td,{children:'String ("[Function]")'})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Future"}),(0,a.jsx)(i.td,{children:'String ("[Future]")'})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Class"}),(0,a.jsx)(i.td,{children:'String ("[Class]")'})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Object"}),(0,a.jsx)(i.td,{children:'String ("[Object]")'})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Null"}),(0,a.jsx)(i.td,{children:"null"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Exception"}),(0,a.jsx)(i.td,{children:"Object with message, label, code, and stacktrace"})]}),(0,a.jsxs)(i.tr,{children:[(0,a.jsx)(i.td,{children:"Throwable"}),(0,a.jsx)(i.td,{children:'Object with "ExceptionThrown" property'})]})]})]}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L70-L130",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp70-130"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L131-L216",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp131-216"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L217-L294",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp217-294"})}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"2-metacall-native-format",children:"2. MetaCall Native Format"}),"\n",(0,a.jsx)(i.p,{children:"The MetaCall native format is a simpler string-based representation primarily used for debugging and internal display. It uses format strings to represent values directly."}),"\n",(0,a.jsx)(i.p,{children:"Format strings used in native serialization:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/metacall_serial/source/metacall_serial_impl_serialize.c#L83-L106",children:"source/serials/metacall_serial/source/metacall_serial_impl_serialize.c83-106"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/metacall_serial/source/metacall_serial_impl_serialize.c#L145-L186",children:"source/serials/metacall_serial/source/metacall_serial_impl_serialize.c145-186"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"serialization-and-deserialization-process",children:"Serialization and Deserialization Process"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L131-L144",children:"source/tests/serial_test/source/serial_test.cpp131-144"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L198-L220",children:"source/tests/serial_test/source/serial_test.cpp198-220"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"type-handling-in-rapidjson-serialization",children:"Type Handling in RapidJSON Serialization"}),"\n",(0,a.jsx)(i.h3,{id:"primitives-and-simple-types",children:"Primitives and Simple Types"}),"\n",(0,a.jsx)(i.p,{children:"The RapidJSON serializer handles basic types like numbers, strings, and booleans directly:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L74-L85",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp74-85"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L98-L102",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp98-102"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L124-L132",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp124-132"})}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"complex-types-buffer-array-map",children:"Complex Types (Buffer, Array, Map)"}),"\n",(0,a.jsx)(i.p,{children:"Complex types require recursive processing:"}),"\n",(0,a.jsx)(i.h4,{id:"buffer-serialization",children:"Buffer Serialization"}),"\n",(0,a.jsx)(i.p,{children:'Buffer is serialized as a JSON object with "data" array and "length" field:'}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L134-L173",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp134-173"})}),"\n"]}),"\n",(0,a.jsx)(i.h4,{id:"array-serialization",children:"Array Serialization"}),"\n",(0,a.jsx)(i.p,{children:"Array is serialized as a JSON array:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L175-L192",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp175-192"})}),"\n"]}),"\n",(0,a.jsx)(i.h4,{id:"map-serialization",children:"Map Serialization"}),"\n",(0,a.jsx)(i.p,{children:"Map is serialized as a JSON object:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L194-L216",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp194-216"})}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"special-types-exception-throwable",children:"Special Types (Exception, Throwable)"}),"\n",(0,a.jsx)(i.p,{children:"Exception and throwable types have special handling:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L261-L293",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp261-293"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L295-L313",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp295-313"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"deserialization-process",children:"Deserialization Process"}),"\n",(0,a.jsx)(i.p,{children:"Deserialization follows a similar pattern but in reverse. The RapidJSON deserializer examines the JSON value type and creates the appropriate MetaCall value:"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L371-L428",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp371-428"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L434-L472",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp434-472"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L473-L517",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp473-517"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"using-the-serialization-api",children:"Using the Serialization API"}),"\n",(0,a.jsx)(i.h3,{id:"basic-usage-pattern",children:"Basic Usage Pattern"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L75-L133",children:"source/tests/serial_test/source/serial_test.cpp75-133"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L438-L450",children:"source/tests/serial_test/source/serial_test.cpp438-450"})}),"\n"]}),"\n",(0,a.jsx)(i.h3,{id:"examples-with-different-types",children:"Examples with Different Types"}),"\n",(0,a.jsx)(i.h4,{id:"serializing-primitive-values",children:"Serializing Primitive Values"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L374-L435",children:"source/tests/serial_test/source/serial_test.cpp374-435"})}),"\n"]}),"\n",(0,a.jsx)(i.h4,{id:"serializing-complex-types",children:"Serializing Complex Types"}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L86-L115",children:"source/tests/serial_test/source/serial_test.cpp86-115"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/tests/serial_test/source/serial_test.cpp#L134-L164",children:"source/tests/serial_test/source/serial_test.cpp134-164"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"adding-custom-serialization-formats",children:"Adding Custom Serialization Formats"}),"\n",(0,a.jsx)(i.p,{children:"The MetaCall serialization system is extensible. To add a new format, you need to implement five core functions:"}),"\n",(0,a.jsx)(i.p,{children:"These functions follow the pattern established by the existing RapidJSON and MetaCall format implementations."}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L49-L67",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp49-67"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L355-L369",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp355-369"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L525-L549",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp525-549"})}),"\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L551-L561",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp551-561"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,a.jsx)(i.p,{children:"When working with serialization in MetaCall, keep these performance considerations in mind:"}),"\n",(0,a.jsxs)(i.ol,{children:["\n",(0,a.jsx)(i.li,{children:"RapidJSON is optimized for performance but has limitations with extremely large data structures"}),"\n",(0,a.jsx)(i.li,{children:"Complex nested structures may require multiple passes during serialization/deserialization"}),"\n",(0,a.jsx)(i.li,{children:"When possible, reuse serialization handles to avoid initialization overhead"}),"\n",(0,a.jsx)(i.li,{children:"Consider memory usage when working with large structures, especially with the buffer type"}),"\n"]}),"\n",(0,a.jsxs)(i.ul,{children:["\n",(0,a.jsx)(i.li,{children:(0,a.jsx)(i.a,{href:"https://github.com/metacall/core/blob/af9cad19/source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp#L15-L16",children:"source/serials/rapid_json_serial/source/rapid_json_serial_impl.cpp15-16"})}),"\n"]}),"\n",(0,a.jsx)(i.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,a.jsx)(i.p,{children:"MetaCall's serialization system provides a flexible way to convert between in-memory values and various data formats. The primary supported format is JSON via RapidJSON, with a simpler string-based MetaCall format also available. The system's modular design allows for adding custom formats to meet specific requirements."})]})}function p(e={}){const{wrapper:i}={...(0,l.R)(),...e.components};return i?(0,a.jsx)(i,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,i,s)=>{s.d(i,{R:()=>t,x:()=>n});var r=s(6540);const a={},l=r.createContext(a);function t(e){const i=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function n(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),r.createElement(l.Provider,{value:i},e.children)}}}]);