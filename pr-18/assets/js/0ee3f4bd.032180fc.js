"use strict";(globalThis.webpackChunkmetacall_doc=globalThis.webpackChunkmetacall_doc||[]).push([[9790],{3782:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"metacall-core/loader-system","title":"Loader System","description":"The Loader System is a core component of MetaCall that enables loading, executing, and interoperating with code written in different programming languages. This system acts as a bridge between the MetaCall core and language-specific runtimes (such as Python, Node.js, Ruby), providing standardized mechanisms to load code and invoke functions across language boundaries.","source":"@site/docs/metacall-core/loader-system.md","sourceDirName":"metacall-core","slug":"/metacall-core/loader-system","permalink":"/doc/pr-18/docs/metacall-core/loader-system","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Loader System"},"sidebar":"tutorialSidebar","previous":{"title":"Java Loader","permalink":"/doc/pr-18/docs/metacall-core/java-loader"},"next":{"title":"Loaders","permalink":"/doc/pr-18/docs/metacall-core/loaders"}}');var s=a(4848),i=a(8453);const t={title:"Loader System"},o="Loader System",d={},l=[{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Loader Interface",id:"loader-interface",level:2},{value:"Interface Methods",id:"interface-methods",level:3},{value:"Loading Process",id:"loading-process",level:2},{value:"Language-Specific Loaders",id:"language-specific-loaders",level:2},{value:"Python Loader (py_loader)",id:"python-loader-py_loader",level:3},{value:"Node.js Loader (node_loader)",id:"nodejs-loader-node_loader",level:3},{value:"Other Loaders",id:"other-loaders",level:3},{value:"Function Call Process",id:"function-call-process",level:2},{value:"Value Type System",id:"value-type-system",level:2},{value:"Asynchronous Support",id:"asynchronous-support",level:2},{value:"Loader Lifecycle",id:"loader-lifecycle",level:2},{value:"Build System Integration",id:"build-system-integration",level:2},{value:"Summary",id:"summary",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"loader-system",children:"Loader System"})}),"\n",(0,s.jsxs)(n.p,{children:["The Loader System is a core component of MetaCall that enables loading, executing, and interoperating with code written in different programming languages. This system acts as a bridge between the MetaCall core and language-specific runtimes (such as Python, Node.js, Ruby), providing standardized mechanisms to load code and invoke functions across language boundaries.\nFor information about how the Loader System is used by ports, see ",(0,s.jsx)(n.a,{href:"/doc/pr-18/docs/metacall-core/port-system",children:"Port System"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsx)(n.p,{children:"The Loader System follows a modular architecture where a central Loader Manager coordinates with various language-specific loaders."}),"\n",(0,s.jsx)(n.h2,{id:"loader-interface",children:"Loader Interface"}),"\n",(0,s.jsxs)(n.p,{children:["Each language-specific loader implements a common interface defined by the ",(0,s.jsx)(n.code,{children:"loader_impl_interface"})," structure. This interface provides a standard set of operations that all loaders must support."]}),"\n",(0,s.jsx)(n.h3,{id:"interface-methods",children:"Interface Methods"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"initialize"})}),(0,s.jsx)(n.td,{children:"Sets up the loader with required configuration and initializes the language runtime"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"execution_path"})}),(0,s.jsx)(n.td,{children:"Defines a path where scripts can be loaded from"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"load_from_file"})}),(0,s.jsx)(n.td,{children:"Loads code from files on disk"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"load_from_memory"})}),(0,s.jsx)(n.td,{children:"Loads code from a buffer in memory"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"load_from_package"})}),(0,s.jsx)(n.td,{children:"Loads code from a package (specific to each language, e.g., DLLs for C#)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"clear"})}),(0,s.jsx)(n.td,{children:"Unloads code previously loaded"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"discover"})}),(0,s.jsx)(n.td,{children:"Discovers function signatures and types from loaded code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"destroy"})}),(0,s.jsx)(n.td,{children:"Cleans up and destroys the loader"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"loading-process",children:"Loading Process"}),"\n",(0,s.jsx)(n.p,{children:"The loading process involves several key steps that bridge between the language-agnostic MetaCall API and language-specific runtimes."}),"\n",(0,s.jsx)(n.h2,{id:"language-specific-loaders",children:"Language-Specific Loaders"}),"\n",(0,s.jsx)(n.p,{children:"Each loader implements language-specific mechanisms to initialize the runtime, load code, and bridge between MetaCall's value system and the language's native types."}),"\n",(0,s.jsx)(n.h3,{id:"python-loader-py_loader",children:"Python Loader (py_loader)"}),"\n",(0,s.jsx)(n.p,{children:"The Python loader initializes a Python interpreter, loads Python scripts, and provides bidirectional conversion between Python objects and MetaCall values."}),"\n",(0,s.jsx)(n.p,{children:"Key features:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Thread-safe Python interpreter access"}),"\n",(0,s.jsx)(n.li,{children:"Support for Python modules and packages"}),"\n",(0,s.jsx)(n.li,{children:"Type conversion between Python and MetaCall"}),"\n",(0,s.jsx)(n.li,{children:"Supports both Python 2 and Python 3"}),"\n",(0,s.jsx)(n.li,{children:"Support for async/await via asyncio"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"nodejs-loader-node_loader",children:"Node.js Loader (node_loader)"}),"\n",(0,s.jsx)(n.p,{children:"The Node.js loader creates a Node.js runtime environment, loads JavaScript code, and handles asynchronous operations using Node.js event loop."}),"\n",(0,s.jsx)(n.p,{children:"Key features:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Bootstrap system to initialize Node.js"}),"\n",(0,s.jsx)(n.li,{children:"JavaScript parsing for function discovery"}),"\n",(0,s.jsx)(n.li,{children:"Promise support for async operations"}),"\n",(0,s.jsx)(n.li,{children:"N-API integration for stable interface"}),"\n",(0,s.jsx)(n.li,{children:"Support for JavaScript modules"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The Node.js loader is particularly complex as it needs to maintain its own thread to run the Node.js event loop:"}),"\n",(0,s.jsx)(n.h3,{id:"other-loaders",children:"Other Loaders"}),"\n",(0,s.jsx)(n.p,{children:"The Loader System includes several other language loaders, each with similar architecture but specialized for their language runtime:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ruby Loader (rb_loader)"}),": Integrates with the Ruby interpreter"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"C# Loader (cs_loader)"}),": Uses CoreCLR to run .NET code"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"TypeScript Loader (ts_loader)"}),": Transpiles TypeScript to JavaScript and uses the Node.js loader"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"C Loader (c_loader)"}),": Compiles C code at runtime using TCC"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"JavaScript V8 Loader (js_loader)"}),": Uses V8 directly without Node.js"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"function-call-process",children:"Function Call Process"}),"\n",(0,s.jsx)(n.p,{children:"Once code is loaded, the Loader System provides mechanisms to discover and call functions across language boundaries."}),"\n",(0,s.jsx)(n.h2,{id:"value-type-system",children:"Value Type System"}),"\n",(0,s.jsx)(n.p,{children:"A critical aspect of the Loader System is the bidirectional conversion between MetaCall's value system and each language's native types."}),"\n",(0,s.jsx)(n.h2,{id:"asynchronous-support",children:"Asynchronous Support"}),"\n",(0,s.jsx)(n.p,{children:"The Loader System provides support for asynchronous programming models, allowing for non-blocking function calls across languages."}),"\n",(0,s.jsx)(n.h2,{id:"loader-lifecycle",children:"Loader Lifecycle"}),"\n",(0,s.jsx)(n.p,{children:"Each loader follows a standard lifecycle from initialization to destruction."}),"\n",(0,s.jsx)(n.h2,{id:"build-system-integration",children:"Build System Integration"}),"\n",(0,s.jsx)(n.p,{children:"Each loader is built as a separate plugin module that can be loaded at runtime by MetaCall."}),"\n",(0,s.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(n.p,{children:"The Loader System is a versatile and extensible component of MetaCall that enables cross-language interoperability. By providing a common interface implemented by language-specific loaders, it allows seamless function calls across different programming languages. Each loader handles the complexities of initializing language runtimes, loading code, and converting between value types, presenting a unified interface to the MetaCall core."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>t,x:()=>o});var r=a(6540);const s={},i=r.createContext(s);function t(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);